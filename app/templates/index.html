{%extends 'main_base.html'%}

{%block title%}CHAT GPT API{%endblock%}

{%block content%}
<script>
document.querySelector('form').addEventListener('submit', async function(e) {
    e.preventDefault();  // Evita recarga

    const formData = new FormData(this);
    const response = await fetch('/', {
        method: 'POST',
        body: formData
    });

    const html = await response.text();
    document.body.innerHTML = html;  // Actualiza la página con nueva respuesta
});
</script>

<div class="container mb-3">
    <h2 class="text-center mb-3">OpenAI Chat API</h2>
    <!-- <form action="/" method="post"> -->
        <form action="/" method="post" enctype="multipart/form-data">
        <!-- Controles de parámetros -->
        <div class="row mx-3 mb-3">
            <div class="col-md-6">
                <label for="temperature" class="form-label">Temperature (0-1):</label>
                <input type="number" class="form-control" name="temperature" id="temperature" 
                       value="0.5" min="0" max="1" step="0.1">
                <small class="text-muted">Creatividad: 0=preciso, 1=creativo</small>
            </div>
            <div class="col-md-6">
                <label for="max_tokens" class="form-label">Max Tokens:</label>
                <input type="number" class="form-control" name="max_tokens" id="max_tokens" 
                       value="3000" min="10" max="5000" step="10">
                <small class="text-muted">Longitud de respuesta</small>
            </div>
        </div>
        
        <div class="row mx-3 mb-3">
            <div class="col-md-4">
                <label for="top_p" class="form-label">Top P (0-1):</label>
                <input type="number" class="form-control" name="top_p" id="top_p" 
                       value="1" min="0" max="1" step="0.1">
                <small class="text-muted">Enfoque</small>
            </div>
            <div class="col-md-4">
                <label for="frequency_penalty" class="form-label">Frequency Penalty (0-2):</label>
                <input type="number" class="form-control" name="frequency_penalty" id="frequency_penalty" 
                       value="0.2" min="0" max="2" step="0.1">
                <small class="text-muted">Evita repetir palabras</small>
            </div>
            <div class="col-md-4">
                <label for="presence_penalty" class="form-label">Presence Penalty (0-2):</label>
                <input type="number" class="form-control" name="presence_penalty" id="presence_penalty" 
                       value="0.8" min="0" max="2" step="0.1">
                <small class="text-muted">Explora nuevos temas</small>
            </div>
        </div>
        <!-- <input type="file" class="form-control mb-3 mx-3" name="file"> -->
         <div class="mb-3 mx-3">
            <label for="file" class="form-label">Adjuntar archivo (PDF, Word o imagen):</label>
            <input type="file" class="form-control" name="file" id="file">
        </div>

        <div class="d-flex">
            <input type="text" class="form-control mb-3 mx-3 w-75" name="question">
            <button class="btn btn-primary mx-3 w-15 h-75" type="submit">Enviar</button>
        </div>
        
    </form>

    <div class="card overflow-auto mx-3" style="height: 400px;">
        <div class="card-body">
            {% for c in chat %}
            <p> {{c}}</p>
            {%endfor%}
        </div>
    </div>
</div>
{%endblock%}